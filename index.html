<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>工單產生器v1.0</title>
    <meta name="description" content="@2025">
    <meta name="robots" content="noindex, nofollow" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.6/Sortable.min.js" integrity="sha512-csIng5zcB+XpulRUa+ev1zKo7zRNGpEaVfNB9On1no9KYTEY/rLGAEEpvgdw6nim1WdTuihZY1eqZ31K7/fZjw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script id="excel" src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
    <style>
      table
      {
        width: 100%;
      }
      table, td
      {
        border: solid 1px black;
      }
      td
      {
        background-color: white;
        white-space: nowrap;
        padding: 10px 20px;
        position: relative;
        vertical-align: top;
      }
      td span
      {
        display: block;
        cursor: pointer;
      }
      td i
      {
        display: none;
        position: absolute;
        top: 0;
        right: 0;
        z-index: 2;
        color: white;
        background-color: red;
        width: 16px;
        height: 16px;
        line-height: 1;
      }
      td:hover > i
      {
        display: block;
      }
      .table-responsive
      {
        position: relative;
      }
      /* 水平捲軸 */
      .table-responsive::-webkit-scrollbar {
        height: 8px; /* 捲軸高度 */
      }
      .table-responsive::-webkit-scrollbar-track {
        background: #f1f1f1; /* 底色 */
      }
      .table-responsive::-webkit-scrollbar-thumb {
        background: #888;    /* 滑塊顏色 */
        border-radius: 4px;
      }
      .table-responsive::-webkit-scrollbar-thumb:hover {
        background: #555;
      }
      .table-responsive > p
      {
        position: sticky;
        left: 0;
        bottom: 0;
        width: 100%;
        text-align: center;
      }
    </style>
  </head>
  <body> 
    <div class="container py-4 px-3">
      <h1 class="mb-4">工單產生器v1.0</h1>
      <ul class="nav nav-tabs flex-nowrap overflow-x-scroll overflow-hidden" id="" role="tablist">
        <li class="nav-item flex-shrink-0" role="presentation">
          <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#tab-pane-1" type="button" role="tab" aria-controls="tab-pane-1" aria-selected="true">舒適層</button>
        </li>
        <li class="nav-item flex-shrink-0" role="presentation">
          <button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-pane-2" type="button" role="tab" aria-controls="tab-pane-2" aria-selected="false">支撐層</button>
        </li>
        <li class="nav-item flex-shrink-0" role="presentation">
          <button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-pane-3" type="button" role="tab" aria-controls="tab-pane-3" aria-selected="false">配件</button>
        </li>
        <li class="nav-item flex-shrink-0" role="presentation">
          <button class="nav-link" data-bs-toggle="tab" data-bs-target="#tab-pane-4" type="button" role="tab" aria-controls="tab-pane-4" aria-selected="false">床墊工法</button>
        </li>
      </ul>
      <div class="tab-content p-3 border border-top-0" id="buttons">
        <div class="tab-pane fade show active" id="tab-pane-1" role="tabpanel" aria-labelledby="tab-1" tabindex="0">
          <div class="d-flex align-items-start">
            <div class="nav flex-column nav-pills me-3 flex-shrink-0 gap-1" id="v-pills-tab" role="tablist" aria-orientation="vertical">
              <button class="btn-sm btn btn-outline-primary active" id="tab-1-1" data-bs-toggle="pill" data-bs-target="#tab-panel-1-1" type="button" role="tab" aria-controls="tab-panel-1-1" aria-selected="true">聚合</button>
              <button class="btn-sm btn btn-outline-primary" id="tab-1-2" data-bs-toggle="pill" data-bs-target="#tab-panel-1-2" type="button" role="tab" aria-controls="tab-panel-1-1" aria-selected="true">泡棉</button>
              <button class="btn-sm btn btn-outline-primary" id="tab-1-3" data-bs-toggle="pill" data-bs-target="#tab-panel-1-3" type="button" role="tab" aria-controls="tab-panel-1-1" aria-selected="true">記憶</button>
              <button class="btn-sm btn btn-outline-primary" id="tab-1-4" data-bs-toggle="pill" data-bs-target="#tab-panel-1-4" type="button" role="tab" aria-controls="tab-panel-1-1" aria-selected="true">乳膠</button>
              <button class="btn-sm btn btn-outline-primary" id="tab-1-5" data-bs-toggle="pill" data-bs-target="#tab-panel-1-5" type="button" role="tab" aria-controls="tab-panel-1-1" aria-selected="true">馬毛</button>
              <button class="btn-sm btn btn-outline-primary" id="tab-1-6" data-bs-toggle="pill" data-bs-target="#tab-panel-1-6" type="button" role="tab" aria-controls="tab-panel-1-1" aria-selected="true">羊毛</button>
              <button class="btn-sm btn btn-outline-primary" id="tab-1-7" data-bs-toggle="pill" data-bs-target="#tab-panel-1-7" type="button" role="tab" aria-controls="tab-panel-1-1" aria-selected="true">蠶絲</button>
              <button class="btn-sm btn btn-outline-primary" id="tab-1-8" data-bs-toggle="pill" data-bs-target="#tab-panel-1-8" type="button" role="tab" aria-controls="tab-panel-1-1" aria-selected="true">彈性棉</button>
              <button class="btn-sm btn btn-outline-primary" id="tab-1-9" data-bs-toggle="pill" data-bs-target="#tab-panel-1-9" type="button" role="tab" aria-controls="tab-panel-1-1" aria-selected="true">樹酯被</button>
              <button class="btn-sm btn btn-outline-primary" id="tab-1-10" data-bs-toggle="pill" data-bs-target="#tab-panel-1-10" type="button" role="tab" aria-controls="tab-panel-1-1" aria-selected="true">3cm彈簧</button>
            </div>
            <div class="tab-content p-3 bg-body-secondary flex-grow-1" id="">
              <div class="tab-pane fade show active" id="tab-panel-1-1" role="tabpanel" aria-labelledby="tab-1-1" tabindex="0">
                <div class="row g-2">
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">聚1</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">聚2</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">聚3</button></div>
                </div>
              </div>
              <div class="tab-pane fade show" id="tab-panel-1-2" role="tabpanel" aria-labelledby="tab-1-2" tabindex="0">
                <div class="row g-2">
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">M粉泡2</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">M粉泡4</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">Z白泡2</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">Z灰泡2</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">Z灰泡4</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">J藍泡2</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">J藍泡4</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">J軟泡1</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">J硬泡1</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">J硬泡2</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">S備長炭2</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">S平安夜軟2</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">S平安夜軟3.5</button></div>
                </div>
              </div>
              <div class="tab-pane fade show" id="tab-panel-1-3" role="tabpanel" aria-labelledby="tab-1-3" tabindex="0">
                <div class="row g-2">
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">M矽2.5</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">Ｍ矽5</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">Z軟矽2.5</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">Z軟矽5</button></div>
                </div>
              </div>
              <div class="tab-pane fade show" id="tab-panel-1-4" role="tabpanel" aria-labelledby="tab-1-4" tabindex="0">
                <div class="row g-2">
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">乳1</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">乳2.5</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">乳5</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">比利時乳2.5</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">開模乳5</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">七段乳5</button></div>
                </div>
              </div>
              <div class="tab-pane fade show" id="tab-panel-1-5" role="tabpanel" aria-labelledby="tab-1-5" tabindex="0">
                <div class="row g-2">
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">馬毛</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">黑馬毛</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">馬毛3.5KG</button></div>
                </div>
              </div>
              <div class="tab-pane fade show" id="tab-panel-1-6" role="tabpanel" aria-labelledby="tab-1-6" tabindex="0">
                <div class="row g-2">
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">羊毛</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">美麗諾羊毛</button></div>
                </div>
              </div>
              <div class="tab-pane fade show" id="tab-panel-1-7" role="tabpanel" aria-labelledby="tab-1-7" tabindex="0">
                <div class="row g-2">
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">蠶絲</button></div>
                </div>
              </div>
              <div class="tab-pane fade show" id="tab-panel-1-8" role="tabpanel" aria-labelledby="tab-1-8" tabindex="0">
                <div class="row g-2">
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">彈性棉2</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">彈性棉5</button></div>
                </div>
              </div>
              <div class="tab-pane fade show" id="tab-panel-1-9" role="tabpanel" aria-labelledby="tab-1-9" tabindex="0">
                <div class="row g-2">
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">樹酯被</button></div>
                </div>
              </div>
              <div class="tab-pane fade show" id="tab-panel-1-10" role="tabpanel" aria-labelledby="tab-1-10" tabindex="0">
                <div class="row g-2">
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">陸3CM</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">德鋼3CM</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">英鋼3CM</button></div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="tab-pane fade" id="tab-pane-2" role="tabpanel" aria-labelledby="profile-tab" tabindex="0">
          <div class="d-flex align-items-start">
            <div class="nav flex-column nav-pills me-3 flex-shrink-0 gap-1" id="v-pills-tab" role="tablist" aria-orientation="vertical">
              <button class="btn-sm btn btn-outline-primary active" id="tab-2-1" data-bs-toggle="pill" data-bs-target="#tab-panel-2-1" type="button" role="tab" aria-controls="tab-panel-2-1" aria-selected="true">彈簧</button>
              <button class="btn-sm btn btn-outline-primary" id="tab-2-2" data-bs-toggle="pill" data-bs-target="#tab-panel-2-2" type="button" role="tab" aria-controls="tab-panel-2-2" aria-selected="true">輔助</button>
              <button class="btn-sm btn btn-outline-primary" id="tab-2-3" data-bs-toggle="pill" data-bs-target="#tab-panel-2-3" type="button" role="tab" aria-controls="tab-panel-2-3" aria-selected="true">泡條</button>
              <button class="btn-sm btn btn-outline-primary" id="tab-2-4" data-bs-toggle="pill" data-bs-target="#tab-panel-2-4" type="button" role="tab" aria-controls="tab-panel-2-4" aria-selected="true">PE</button>
              <button class="btn-sm btn btn-outline-primary" id="tab-2-5" data-bs-toggle="pill" data-bs-target="#tab-panel-2-5" type="button" role="tab" aria-controls="tab-panel-2-5" aria-selected="true">樹酯棉<br>(三折墊)</button>
              <button class="btn-sm btn btn-outline-primary" id="tab-2-6" data-bs-toggle="pill" data-bs-target="#tab-panel-2-6" type="button" role="tab" aria-controls="tab-panel-2-6" aria-selected="true">防穿刺</button>
              <button class="btn-sm btn btn-outline-primary" id="tab-2-7" data-bs-toggle="pill" data-bs-target="#tab-panel-2-7" type="button" role="tab" aria-controls="tab-panel-2-7" aria-selected="true">絲光棉</button>
              <button class="btn-sm btn btn-outline-primary" id="tab-2-8" data-bs-toggle="pill" data-bs-target="#tab-panel-2-8" type="button" role="tab" aria-controls="tab-panel-2-8" aria-selected="true">棉被</button>
              <button class="btn-sm btn btn-outline-primary" id="tab-2-9" data-bs-toggle="pill" data-bs-target="#tab-panel-2-9" type="button" role="tab" aria-controls="tab-panel-2-9" aria-selected="true">石棉</button>
              <button class="btn-sm btn btn-outline-primary" id="tab-2-10" data-bs-toggle="pill" data-bs-target="#tab-panel-2-10" type="button" role="tab" aria-controls="tab-panel-2-10" aria-selected="true">聚酯棉</button>
            </div>
            <div class="tab-content p-3 bg-body-secondary flex-grow-1" id="">
              <div class="tab-pane fade show active" id="tab-panel-2-1" role="tabpanel" aria-labelledby="tab-2-1" tabindex="0">
                <div class="row g-2">
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">2.3(15)</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">2.3(18)</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">2.6(15)</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">2.6(18)</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">台獨硬獨20</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">獨20</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">硬獨20</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">硬獨25</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">獨蜂20</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">硬蜂20</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">五段20</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">667(20)</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">900(20)</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">1200(20)</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">2000(20)</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">低獨10</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">低黑彈簧10CM</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">大芯網</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">獨8環(18)</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">A-20</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">B白-20</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">德C-20</button></div>
                </div>
              </div>
              <div class="tab-pane fade show" id="tab-panel-2-2" role="tabpanel" aria-labelledby="tab-2-2" tabindex="0">
                <div class="row g-2">
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">免輔</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">四輔</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">四輔(4433)</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">四輔助滿</button></div>
                </div>
              </div>
              <div class="tab-pane fade show" id="tab-panel-2-3" role="tabpanel" aria-labelledby="tab-2-3" tabindex="0">
                <div class="row g-2">
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">上框黃軟泡８</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">Ｍ白20</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">Ｍ軟20</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">全封</button></div>
                </div>
              </div>
              <div class="tab-pane fade show" id="tab-panel-2-4" role="tabpanel" aria-labelledby="tab-2-4" tabindex="0">
                <div class="row g-2">
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">PE3</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">PE5</button></div>
                </div>
              </div>
              <div class="tab-pane fade show" id="tab-panel-2-5" role="tabpanel" aria-labelledby="tab-2-5" tabindex="0">
                <div class="row g-2">
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">樹酯棉3</button></div>
                </div>
              </div>
              <div class="tab-pane fade show" id="tab-panel-2-6" role="tabpanel" aria-labelledby="tab-2-6" tabindex="0">
                <div class="row g-2">
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">防穿刺</button></div>
                </div>
              </div>
              <div class="tab-pane fade show" id="tab-panel-2-7" role="tabpanel" aria-labelledby="tab-2-7" tabindex="0">
                <div class="row g-2">
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">絲光棉</button></div>
                </div>
              </div>
              <div class="tab-pane fade show" id="tab-panel-2-8" role="tabpanel" aria-labelledby="tab-2-8" tabindex="0">
                <div class="row g-2">
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">棉被</button></div>
                </div>
              </div>
              <div class="tab-pane fade show" id="tab-panel-2-9" role="tabpanel" aria-labelledby="tab-2-9" tabindex="0">
                <div class="row g-2">
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">兩面薄石</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">兩面厚石</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">正免石</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">反免石</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">*改 正加厚石*</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">*正另加薄石*</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">雙免石</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">兩面白薄石</button></div>
                </div>
              </div>
              <div class="tab-pane fade show" id="tab-panel-2-10" role="tabpanel" aria-labelledby="tab-2-10" tabindex="0">
                <div class="row g-2">
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">聚酯棉2</button></div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="tab-pane fade" id="tab-pane-3" role="tabpanel" aria-labelledby="profile-tab" tabindex="0">
          <div class="d-flex align-items-start">
            <div class="nav flex-column nav-pills me-3 flex-shrink-0 gap-1" id="v-pills-tab" role="tablist" aria-orientation="vertical">
              <button class="btn-sm btn btn-outline-primary active" id="tab-3-1" data-bs-toggle="pill" data-bs-target="#tab-panel-3-1" type="button" role="tab" aria-controls="tab-panel-3-1" aria-selected="true">織帶</button>
            </div>
            <div class="tab-content p-3 bg-body-secondary flex-grow-1" id="">
              <div class="tab-pane fade show active" id="tab-panel-3-1" role="tabpanel" aria-labelledby="tab-3-1" tabindex="0">
                <div class="row g-2">
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">白</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">藍</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">黑菱</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">貓米</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">平安</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">深藍</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">線金</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">貓綠</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">黑</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">雙色</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">線藍</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">貓灰</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">黃</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">淺杏絨</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">蔥粉</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">貓杏</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">灰</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">深杏絨</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">蔥黃</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">貓藍</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">斜灰</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">黑絨</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">蔥灰</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">藍雙</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">米</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">綠絨</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">點黑</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">白x藍</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">咖</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">咖絨</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">點藍</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">點白</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">金</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">灰絨</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">點黃</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">平銀</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">銀</button></div>
                  <div class="col-auto"><button class="material btn btn-light btn-sm" type="button">粉絨</button></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="order-info my-3 row g-2">
        <div class="col-12 col-md-4">
          <label for="input-customer" class="form-label">客戶名稱（必填）</label>
          <input type="text" class="form-control watch-change" data-target="customer">
        </div>
        <div class="col-12 col-md-4">
          <label for="input-customer" class="form-label">聯絡電話（必填）</label>
          <input type="text" class="form-control watch-change" data-target="phone">
        </div>
        <div class="col-12 col-md-4">
          <label for="input-customer" class="form-label">日期</label>
          <input type="date" class="form-control watch-change" data-target="date">
        </div>
        <div class="col-12 m-0"></div>
        <div class="col-12 col-md-4">
          <label for="input-customer" class="form-label">數量（必填）</label>
          <input type="number" class="form-control watch-change" data-target="qty">
        </div>
        <div class="col-12">
          <label for="input-customer" class="form-label">訂單備注</label>
          <textarea name="" id="" class="form-control watch-change" data-target="remark" rows="5"></textarea>
        </div>
      </div>
      <div class="tools pt-3 d-none">
        <!-- <button type="button" id="copy" class="btn btn-sm btn-success">複製</button> -->
        <button type="button" id="export" class="btn btn-sm btn-success">匯出.xlsx</button>
        <button type="button" id="clear" class="btn btn-sm btn-danger">清空</button>
      </div>
      <div class="table-responsive pt-3">
        <table id="order">
          <tr>
            <td width="130px">客戶名稱</td>
            <td colspan="9" id="customer"></td>
          </tr>
          <tr>
            <td width="130px">聯絡電話</td>
            <td colspan="9" id="phone"></td>
          </tr>
          <tr>
            <td width="130px">日期</td>
            <td colspan="9" id="date"></td>
          </tr>
          <tr>
            <td width="130px">數量</td>
            <td colspan="9" id="qty"></td>
          </tr>
          <tr>
            <td class="bg-dark-subtle" colspan="10">訂單內容</td>
          </tr>
          <tr id="items"><td colspan="10" class="text-secondary text-center empty">尚未選擇</td></tr>
          <tr>
            <td width="130px">訂單備注</td>
            <td colspan="9" id="remark"></td>
          </tr>
        </table>
        <p class="my-4 text-danger">使用手機時，左右滑動此處可以看到更多</p>
      </div>
    </div>
    <script>
      function action()
      {
        let len = $('#items td:not(.empty)').length
        if (len > 0) {
          $('td.empty').remove()
          $('.tools').removeClass('d-none')
          $('.table-responsive').stop().animate({scrollLeft:$('#items').innerWidth()},800)
        } else {
          $('.tools').addClass('d-none')
          $('#items').html(`<td colspan="10" class="text-secondary text-center empty">尚未選擇</td>`)
        }
      }

      $(document).on('click','#buttons .material',function(){
        let text = $(this).text().trim()
        let transform = $(this).data('transform')
        if (transform != undefined) {
          text = transform
        }
        let html = `<td>${text}<i class="bi bi-x"></i></td>`
        $('#items').append(html)
        action()
      })
      
      const sortable1El = document.getElementById('items')
      const sortable1 = Sortable.create(sortable1El, {
        swapThreshold: 1,
        animation: 150,
        filter: '.empty',
        ghostClass: 'bg-warning-subtle'
      })

      $(document).on("click",'table td i',function(e){
        e.preventDefault
        $(this).closest('td').remove()
        action()
      })

      $('#clear').on("click",function(e){
        action()
      })

      $('#copy').on("click",function(e){
        var $temp = $("<textarea>");
        $("body").append($temp);

        const cells = [];
        $('#items td').each(function(){
          let text = $(this).text().trim();
          cells.push(text);
        });
        let output = cells.join('\t');
        $temp.val(output).select();
        document.execCommand("copy");
        $temp.remove();
        alert('已複製')
      })

       $('#export').on('click',function(){

        let check = $('#customer').text() == "" || $('#phone').text() == "" || $('#qty').text() == ""

        if (check) {
          return alert('請檢查必填項目')
        }

        // 取得 Table
        var table = document.getElementById("order").cloneNode(true); // clone → 不影響原本 DOM

        // 🔑 處理所有 td/th
        Array.from(table.querySelectorAll("td,th")).forEach(cell => {
          // 把 <i> 標籤隱藏 (不刪掉功能)
          cell.querySelectorAll("i").forEach(el => {
            el.style.display = "none";   // 匯出的時候不會顯示
            el.textContent = "";         // 確保不帶出 icon 符號
          });

          // 把 <br> 換成換行符號
          cell.innerHTML = cell.innerHTML.replace(/<br\s*\/?>/gi, "\r\n");

          // 強制取純文字
          cell.textContent = String(cell.textContent.trim());
        });

        // 🚨 注意：這裡請用 aoa_to_sheet，不要再用 table_to_sheet
        var aoa = [];
        Array.from(table.rows).forEach(row => {
          var rowData = [];
          Array.from(row.cells).forEach(cell => {
            rowData.push(cell.textContent);
          });
          aoa.push(rowData);
        });
  
        // 轉成 worksheet
        var worksheet = XLSX.utils.aoa_to_sheet(aoa);

        // 🔑 遍歷所有欄位 → 強制文字、允許換行
        for (const cell in worksheet) {
          if (cell[0] === "!") continue;
          worksheet[cell].t = "s";
          worksheet[cell].z = "@";
          worksheet[cell].s = { 
            alignment: { 
              wrapText: true,
              horizontal: "left",
              vertical: "top"
            }
          };
        }

        // 建立 workbook
        var workbook = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(workbook, worksheet, "訂單");
  
        // 下載 Excel 檔
        XLSX.writeFile(workbook, "訂單.xlsx");

      })

      $('.watch-change').on('keyup change',function(){
        let target = $(this).data('target')
        if (target == 'remark') {
          $(`#${target}`).html($(this).val().replace(/\n/g,'<br>'))
        } else {
          $(`#${target}`).text($(this).val())
        }
      })

    </script>
  </body>
</html>
